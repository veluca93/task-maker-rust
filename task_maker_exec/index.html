<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="DAG execution dispatching the tasks to the workers."><meta name="keywords" content="rust, rustlang, rust-lang, task_maker_exec"><title>task_maker_exec - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../dark.css" disabled><link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../storage.js"></script><script src="../crates.js"></script><script defer src="../main.js"></script>
    <noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../task_maker_exec/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"></h2>
    </nav>
    <nav class="sidebar"><a class="sidebar-logo" href="../task_maker_exec/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"><a href="#">Crate task_maker_exec</a></h2><div class="sidebar-elems"><div class="block"><ul><li class="version">Version 0.5.5</li><li><a id="all-types" href="all.html">All Items</a></li></div></ul><section><div class="block"><ul><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li><li><a href="#traits">Traits</a></li><li><a href="#functions">Functions</a></li></ul></div></section><div id="sidebar-vars" data-name="task_maker_exec" data-ty="mod" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../task_maker_exec/index.html"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></a><nav class="sub"><div class="theme-picker hidden"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="22" height="22" alt="Pick another theme!" src="../brush.svg"></button><div id="theme-choices" role="menu"></div></div><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../wheel.svg"></a></div></form></nav></div><section id="main-content" class="content"><div class="main-heading">
    <h1 class="fqn"><span class="in-band">Crate <a class="mod" href="#">task_maker_exec</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../src/task_maker_exec/lib.rs.html#1-254">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>DAG execution dispatching the tasks to the workers.</p>
<p>This crate is able to setup a distributed execution environment by creating an <code>Executor</code> which
spawns some workers, and a client which, talking to the executor, is able to schedule the
execution of a DAG.</p>
<p>A <a href="../task_maker_store/struct.FileStore.html"><code>FileStore</code></a> is used to store the files of the DAG
and <a href="https://doc.rust-lang.org/std/sync/mpsc/fn.channel.html"><code>std::sync::mpsc::channel</code></a> is
used for the internal communication.</p>
<p>A simple <code>Scheduler</code> is used to dispatch the jobs when all their dependencies are ready. When an
execution is not successful (i.e. does not return with zero) all the depending jobs are
cancelled.</p>
<p>All the tasks are run inside a <a href="struct.Sandbox.html"><code>Sandbox</code></a> provided by
<a href="https://crates.io/crates/tabox"><code>tabox</code></a>.</p>
<h3 id="implementation-details"><a href="#implementation-details">Implementation details</a></h3>
<p>In order to support both local and remote evaluation, sharing the same code and logic we need a
layer of abstraction over the execution.</p>
<p>The components of the execution are:</p>
<ul>
<li><a href="struct.ExecutorClient.html"><code>ExecutorClient</code></a> (from now <code>Client</code>) is the component that runs
on the process that wants to execute the DAG, it asks to its executor to run it and gets the
results eventually processing them.</li>
<li><a href="executors/struct.LocalExecutor.html"><code>LocalExecutor</code></a> the component to which the <code>Client</code>
connects to for executing a DAG locally, it internally uses an <code>Executor</code> for actually running
the DAG, but also spawns local workers.</li>
<li><a href="executors/struct.RemoteExecutor.html"><code>RemoteExecutor</code></a> the component to which the <code>Client</code>
connects to for executing a DAG remotely. This usually runs on a remote machine w.r.t the
client’s one. It internally uses an <code>Executor</code> for running the DAG but doesn’t spawn the
workers since they are remote too. This component is also responsible for listening to the
sockets for the connections of the clients and the workers.</li>
<li><code>Executor</code> the component that abstracts the connection of workers and clients and handles the
actual communication between the scheduler and the clients. This component is also responsible
for spawning the scheduler and keeping it working.</li>
<li><code>Scheduler</code> the component that, given DAGs and notification about the status of the workers
(i.e. worker connection/disconnection/job completion) schedules the execution of the ready
jobs and sends to the clients the notification about their status.</li>
<li><code>WorkerManager</code> the component that handles the connections with the workers and notifies the
scheduler about worker events.</li>
<li><code>Worker</code> the component that actively asks for work to do, waiting a response from the
scheduler, and eventually receive and execute it. After the execution completes, the worker
asks for another job to do.</li>
</ul>
<h4 id="local-execution"><a href="#local-execution">Local execution</a></h4>
<p><img src="https://www.lucidchart.com/publicSegments/view/f0ad0719-2dd4-4c60-9da0-ca0614fd37a1/image.png" alt="Local execution diagram" /></p>
<p>Running locally all the components are spawn in the current process, but different threads.
The communication between them is done using in memory channels, including the one from the
<code>Client</code> to the <code>LocalExecutor</code>.</p>
<p>The <code>Client</code> connects to the <code>LocalExecutor</code>, specifying also the number of workers to spawn.
The local executor spawns an actual executor, a worker manager and that number of workers.</p>
<h4 id="remote-execution"><a href="#remote-execution">Remote execution</a></h4>
<p><img src="https://www.lucidchart.com/publicSegments/view/86167d8f-b231-4698-a8ac-a26ed995fd19/image.png" alt="Local execution diagram" /></p>
<p>In a remote environment the <code>Client</code> connects to the <code>RemoteExecutor</code> via a TCP socket, the
remote executor listens for client and worker connections. The workers then connect to the
<code>RemoteExecutor</code> and they are handled by the <code>WorkerManager</code>.</p>
</div></details><h2 id="reexports" class="small-section-header"><a href="#reexports">Re-exports</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left import-item"><code>pub use ductile;</code></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left import-item"><code>pub use sandbox::<a class="enum" href="sandbox/enum.RawSandboxResult.html" title="enum task_maker_exec::sandbox::RawSandboxResult">RawSandboxResult</a>;</code></div><div class="item-right docblock-short"></div></div></div><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="mod" href="executors/index.html" title="task_maker_exec::executors mod">executors</a></div><div class="item-right docblock-short"><p>The supported executors.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="find_tools/index.html" title="task_maker_exec::find_tools mod">find_tools</a></div><div class="item-right docblock-short"><p>Finds the location of the <code>task-maker-tools</code> executable.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="proto/index.html" title="task_maker_exec::proto mod">proto</a></div><div class="item-right docblock-short"><p>The protocol related structs and enums.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="sandbox/index.html" title="task_maker_exec::sandbox mod">sandbox</a></div><div class="item-right docblock-short"><p>This mod contains the sandbox-related code. It interfaces with tabox creating the sandbox setup
(directories and configuration) for an execution.</p>
</div></div></div><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.ClientInfo.html" title="task_maker_exec::ClientInfo struct">ClientInfo</a></div><div class="item-right docblock-short"><p>Information about a client of the scheduler.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.ErrorSandboxRunner.html" title="task_maker_exec::ErrorSandboxRunner struct">ErrorSandboxRunner</a></div><div class="item-right docblock-short"><p>A fake sandbox that don’t actually spawn anything and always return an error.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.ExecutorClient.html" title="task_maker_exec::ExecutorClient struct">ExecutorClient</a></div><div class="item-right docblock-short"><p>This is a client of the <code>Executor</code>, the client is who sends a DAG for an evaluation, provides
some files and receives the callbacks from the server. When the server notifies a callback
function is called by the client.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.ExecutorStatus.html" title="task_maker_exec::ExecutorStatus struct">ExecutorStatus</a></div><div class="item-right docblock-short"><p>The current status of the <code>Executor</code>, this is sent to the user when the server status is asked.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.ExecutorWorkerStatus.html" title="task_maker_exec::ExecutorWorkerStatus struct">ExecutorWorkerStatus</a></div><div class="item-right docblock-short"><p>Status of a worker of an <code>Executor</code>.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.SuccessSandboxRunner.html" title="task_maker_exec::SuccessSandboxRunner struct">SuccessSandboxRunner</a></div><div class="item-right docblock-short"><p>A fake sandbox that don’t actually spawn anything and always return successfully with exit code
0.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Worker.html" title="task_maker_exec::Worker struct">Worker</a></div><div class="item-right docblock-short"><p>The worker is the component that receives the work from the server and sends the results back.
It computes the results by executing a process inside a sandbox, limiting the available
resources and measuring the used ones.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.WorkerConn.html" title="task_maker_exec::WorkerConn struct">WorkerConn</a></div><div class="item-right docblock-short"><p>An handle of the connection to the worker.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.WorkerCurrentJobStatus.html" title="task_maker_exec::WorkerCurrentJobStatus struct">WorkerCurrentJobStatus</a></div><div class="item-right docblock-short"><p>Information about the job the worker is currently doing.</p>
</div></div></div><h2 id="traits" class="small-section-header"><a href="#traits">Traits</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.SandboxRunner.html" title="task_maker_exec::SandboxRunner trait">SandboxRunner</a></div><div class="item-right docblock-short"><p>Something able to spawn a sandbox, wait for it to exit and return the results.</p>
</div></div></div><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.derive_key_from_password.html" title="task_maker_exec::derive_key_from_password fn">derive_key_from_password</a></div><div class="item-right docblock-short"><p>Derive the encryption key from a password string.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.eval_dag_locally.html" title="task_maker_exec::eval_dag_locally fn">eval_dag_locally</a></div><div class="item-right docblock-short"><p>Evaluate a DAG locally spawning a new <a href="executors/struct.LocalExecutor.html"><code>LocalExecutor</code></a>
with the specified number of workers.</p>
</div></div></div></section><section id="search" class="content hidden"></section></div></main><div id="rustdoc-vars" data-root-path="../" data-current-crate="task_maker_exec" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.61.0 (fe5b13d68 2022-05-18)" ></div>
</body></html>